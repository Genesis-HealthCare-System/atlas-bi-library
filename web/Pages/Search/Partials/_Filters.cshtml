<h2 class="fav-col-title">Filters</h2>

<form id="searchForm">
    @if (ViewBag.Permissions.Contains(46)){
    var advanced = @Model.SearchResults.Advanced == "Y" ? "N" : "Y";
    <div class="srch-fltr">
            
        <div class='form-check search-filter'>
            <input type="checkbox"
                    value="@UrlHelpers.SetSearchFacetUrl(ViewContext.HttpContext, "advanced", @advanced)"
                    checked="@UrlHelpers.SetSearchFacetChecked(Model.SearchResults.Parameters, "advanced",  "Y")" />
            <input type="hidden" />
            <label>Show Advanced Filters</label>
        </div>
    </div>}
    @if (Model.SearchResults.FilterFields.Count > 0)
    {
    <h5 class="fav-col-sub-title">Search Fields</h5>
    <div class="srch-fltr">
        @foreach (var field in Model.SearchResults.FilterFields)
    {
        <div class='form-check search-filter'>
            <input type="checkbox"
                    value="@UrlHelpers.SetSearchFacetUrl(ViewContext.HttpContext, "field", @field.Key)"
                    checked="@UrlHelpers.SetSearchFacetChecked(Model.SearchResults.Parameters, "field", field.Key)" />
            <input type="hidden" />
            <label>@field.FriendlyName</label>
        </div>}
    </div>}

    @foreach (var field in Model.SearchResults.FacetFields)
                    {@* if there is only one value, do not show.*@

                    @if ( Model.SearchResults.Advanced == "Y" && (ViewBag.Permissions.Contains(46) && field.FriendlyName == "Visible") || (field.FriendlyName != "Visible" && field.Values.Count > 1) || field.FriendlyName == "Type" || UrlHelpers.HasFacet(Model.SearchResults.Parameters, field.Key))
                                        {
                    <h5 class="fav-col-sub-title">@field.FriendlyName</h5>
                    <div class="srch-fltr">


                        @foreach (var value in field.Values)
                                                {@* hide filters with 0 matches, or show advanced search *@

    @if ((ViewBag.Permissions.Contains(46) && field.FriendlyName == "Visible") || (field.FriendlyName != "Visible" && (@value.Count > 0 || field.FriendlyName == "Visible" || field.FriendlyName == "Type" || UrlHelpers.SetSearchFacetChecked(Model.SearchResults.Parameters, field.Key, value.Value))))
                                                                            {
    <div class='form-check search-filter'>
        <input type="checkbox" value="@UrlHelpers.SetSearchFacetUrl(ViewContext.HttpContext, @field.Key, @value.Value)" checked="@UrlHelpers.SetSearchFacetChecked(Model.SearchResults.Parameters, @field.Key, @value.Value)" />
        <input type="hidden" />
        <label>@value.FriendlyName<span class="search-badge">@value.Count</span></label>
    </div>}}

    </div>}}

</form>
